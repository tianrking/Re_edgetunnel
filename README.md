# ğŸš€ EdgeTunnel (Refactored)

> **è‡´æ•¬ä¸é¸£è°¢**ï¼š
> æœ¬é¡¹ç›®æ ¸å¿ƒä»£ç†é€»è¾‘å‚è€ƒè‡ªå¼€æºç¤¾åŒºçš„æ°å‡ºè´¡çŒ®ã€‚ç‰¹åˆ«æ„Ÿè°¢ï¼š
> *   **cmliu** ([cmliu/edgetunnel](https://github.com/cmliu/edgetunnel)) - åŸé¡¹ç›®ä½œè€…ï¼Œæä¾›äº†å¼ºå¤§çš„é¢æ¿ä¸é€»è¾‘ã€‚
> *   **zizifn** ([zizifn/edgetunnel](https://github.com/zizifn/edgetunnel)) - æ—©æœŸç‰ˆæœ¬çš„è´¡çŒ®è€…ã€‚

---

> **EdgeTunnel (Refactored)** æ˜¯ä¸€ä¸ªå…¨æ–°æ„å»ºçš„ Cloudflare Workers éš§é“ä»£ç†æ–¹æ¡ˆã€‚
> å®ƒå¸å–äº†ç¤¾åŒºç°æœ‰æ–¹æ¡ˆçš„è®¾è®¡æ€è·¯ï¼Œä½†é‡‡ç”¨**å…¨æ¨¡å—åŒ–æ¶æ„**ä»é›¶é‡å†™ï¼Œä¸“ä¸ºå·¥ç¨‹åŒ–éƒ¨ç½²å’ŒäºŒæ¬¡å¼€å‘è®¾è®¡ã€‚

![Status](https://img.shields.io/badge/Status-Active-success)
![Author](https://img.shields.io/badge/Author-tianrking-blue)

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨ Cloudflare è¾¹ç¼˜ç½‘ç»œä¸Šçš„è½»é‡çº§éš§é“ä»£ç†å·¥å…·ã€‚

æœ¬é¡¹ç›®å¯¹åŸæœ‰çš„å•æ–‡ä»¶è„šæœ¬è¿›è¡Œäº†**å½»åº•é‡æ„**ï¼Œé‡‡ç”¨ç°ä»£åŒ–çš„ **ESM æ¨¡å—æ ‡å‡†**ï¼Œæ”¯æŒ **Wrangler CLI** ä¸€é”®éƒ¨ç½²ã€æœ¬åœ°è°ƒè¯•ä»¥åŠ Git ç‰ˆæœ¬ç®¡ç†ã€‚

å®ƒè§£è€¦äº†é…ç½®ä¸æ ¸å¿ƒé€»è¾‘ï¼Œåˆ©ç”¨ **Cloudflare KV** å­˜å‚¨ç®¡ç†çŠ¶æ€ï¼Œå¹¶é€‚é…å¤šç§é€šä¿¡åè®®ã€‚æ—¨åœ¨æä¾›ä¸€ä¸ªæ›´ç¬¦åˆå·¥ç¨‹åŒ–æ ‡å‡†ã€æ˜“äºæ‰©å±•çš„ Serverless ç½‘ç»œç¼–ç¨‹èŒƒä¾‹ï¼Œé€‚åˆå¼€å‘è€…å­¦ä¹  Worker å¼€å‘ä¸ WebSocket é€šä¿¡æŠ€æœ¯ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ›¡ï¸ **åè®®æ”¯æŒ**ï¼šæ”¯æŒ VLESSã€Trojan ç­‰ä¸»æµåè®®ã€‚
- ğŸ“¦ **æ¨¡å—åŒ–è®¾è®¡**ï¼šä»£ç æ‹†åˆ†ä¸º `src/` ç›®å½•ï¼ŒèŒè´£åˆ†ç¦»ï¼ˆé…ç½®ã€é€»è¾‘ã€æ§åˆ¶å™¨ï¼‰ï¼Œæ˜“äºç»´æŠ¤ã€‚
- ğŸ›  **å·¥ç¨‹åŒ–æ ‡å‡†**ï¼šæ”¯æŒ `wrangler dev` æœ¬åœ°å¼€å‘è°ƒè¯•ï¼Œå‘Šåˆ«åœ¨çº¿ç¼–è¾‘å™¨çš„ä½æ•ˆã€‚
- ğŸ”„ **è®¢é˜…ç³»ç»Ÿ**ï¼šè‡ªåŠ¨ç”Ÿæˆè®¢é˜…é“¾æ¥ï¼Œé€‚é… Clash, Sing-box, Surge ç­‰ã€‚
- âš¡ **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆ©ç”¨ Cloudflare å…¨çƒè¾¹ç¼˜ç½‘ç»œåŠ é€Ÿã€‚

---

## ğŸ›  å¿«é€Ÿéƒ¨ç½² (CLI)

è¯·å®Œå…¨æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œéƒ¨ç½²ã€‚

### 1. å®‰è£…å·¥å…·ä¸ç™»å½•
ç¡®ä¿å·²æœ‰ Node.js ç¯å¢ƒã€‚

```bash
# å®‰è£… Wrangler
npm install -g wrangler

# ç™»å½• Cloudflare (æµè§ˆå™¨æˆæƒ)
npx wrangler login
```

### 2. è·å–ä»£ç 
```bash
git clone https://github.com/tianrking/Re_edgetunnel.git
cd Re_edgetunnel
```

### 3. é…ç½® KV å­˜å‚¨
åˆ›å»ºä¸€ä¸ª KV å‘½åç©ºé—´ç”¨äºå­˜å‚¨é…ç½®ï¼š

```bash
npx wrangler kv namespace create edgetunnel
```

è®°ä¸‹ç»ˆç«¯è¾“å‡ºçš„ `id` (ä¾‹å¦‚ `095b6650...`)ï¼Œç„¶åæ‰“å¼€ `wrangler.toml` æ–‡ä»¶ï¼Œä¿®æ”¹ `[[kv_namespaces]]` éƒ¨åˆ†ï¼š

```toml
[[kv_namespaces]]
binding = "KV"
id = "æ›¿æ¢ä¸ºä½ åˆšåˆšè·å–çš„ID"
```

### 4. éƒ¨ç½²ä¸Šçº¿
```bash
npx wrangler deploy
```

éƒ¨ç½²æˆåŠŸåï¼Œæ§åˆ¶å°ä¼šæ˜¾ç¤º Worker çš„è®¿é—®ç½‘å€ï¼ˆä¾‹å¦‚ `https://edgetunnel.xxx.workers.dev`ï¼‰ã€‚

---

## âš™ï¸ è¿›é˜¶é…ç½®

### ç»‘å®šè‡ªå®šä¹‰åŸŸå
åœ¨ `wrangler.toml` ä¸­æ·»åŠ  `routes`ï¼š

```toml
routes = [
	{ pattern = "tunnel.your-domain.com", custom_domain = true }
]
```
é‡æ–°éƒ¨ç½²ï¼š`npx wrangler deploy`

### ä¿®æ”¹ç®¡ç†å‘˜å¯†ç  (UUID)
é»˜è®¤æƒ…å†µä¸‹ï¼Œé¦–æ¬¡éƒ¨ç½²ä¼šè‡ªåŠ¨ç”Ÿæˆéšæœº UUIDã€‚
å¦‚éœ€å›ºå®šï¼Œè¯·åœ¨ `wrangler.toml` çš„ `[vars]` ä¸­è®¾ç½®ï¼š

```toml
[vars]
UUID = "ä½ çš„UUID"
```

---

## âš ï¸ å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ä¾›æŠ€æœ¯ç ”ç©¶ä¸å­¦ä¹ ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºä»»ä½•éæ³•ç”¨é€”ã€‚ä½œè€…ä¸å¯¹ä½¿ç”¨æœ¬é¡¹ç›®äº§ç”Ÿçš„ä»»ä½•åæœè´Ÿè´£ã€‚